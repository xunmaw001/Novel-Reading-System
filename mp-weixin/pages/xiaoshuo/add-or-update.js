(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/xiaoshuo/add-or-update"],{"0ef3":function(e,t,o){"use strict";(function(e){o("99e5");a(o("66fd"));var t=a(o("346f"));function a(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=o,e(t.default)}).call(this,o("543d")["createPage"])},"1a60":function(e,t,o){},"346f":function(e,t,o){"use strict";o.r(t);var a=o("8efc"),n=o("4a57");for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);o("49b6");var u,r=o("f0c5"),s=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"56d984a5",null,!1,a["a"],u);t["default"]=s.exports},"49b6":function(e,t,o){"use strict";var a=o("1a60"),n=o.n(a);n.a},"4a57":function(e,t,o){"use strict";o.r(t);var a=o("ad13"),n=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,(function(){return a[e]}))}(i);t["default"]=n.a},"8efc":function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return a}));var a={wPicker:function(){return Promise.all([o.e("common/vendor"),o.e("components/w-picker/w-picker")]).then(o.bind(null,"50e8"))}},n=function(){var e=this,t=e.$createElement;e._self._c},i=[]},ad13:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(o("a34a"));function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,o,a,n,i,u){try{var r=e[i](u),s=r.value}catch(c){return void o(c)}r.done?t(s):Promise.resolve(s).then(a,n)}function u(e){return function(){var t=this,o=arguments;return new Promise((function(a,n){var u=e.apply(t,o);function r(e){i(u,a,n,r,s,"next",e)}function s(e){i(u,a,n,r,s,"throw",e)}r(void 0)}))}}var r=function(){Promise.all([o.e("common/vendor"),o.e("components/w-picker/w-picker")]).then(function(){return resolve(o("50e8"))}.bind(null,o)).catch(o.oe)},s={data:function(){return{cross:"",ro:{xiaoshuoName:!1,xiaoshuoPhoto:!1,xiaoshuoZuozhe:!1,xiaoshuoZishu:!1,xiaoshuoTypes:!1,xiaoshuoClicknum:!1,shangxiaTypes:!1,xiaoshuoDelete:!1,xiaoshuoContent:!1,createTime:!1},ruleForm:{xiaoshuoName:"",xiaoshuoPhoto:"",xiaoshuoZuozhe:"",xiaoshuoZishu:"",xiaoshuoTypes:"",xiaoshuoValue:"",xiaoshuoClicknum:"",shangxiaTypes:"",shangxiaValue:"",xiaoshuoDelete:"",xiaoshuoContent:"",createTime:""},user:{},xiaoshuoTypesOptions:[],xiaoshuoTypesIndex:0,shangxiaTypesOptions:[],shangxiaTypesIndex:0}},components:{wPicker:r},computed:{baseUrl:function(){return this.$base.url}},onLoad:function(e){var t=this;return u(a.default.mark((function o(){var n,i,u,r,s;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n={page:1,limit:100,dicCode:"xiaoshuo_types"},o.next=3,t.$api.page("dictionary",n);case 3:return i=o.sent,t.xiaoshuoTypesOptions=i.data.list,u={page:1,limit:100,dicCode:"shangxia_types"},o.next=8,t.$api.page("dictionary",u);case 8:if(r=o.sent,t.shangxiaTypesOptions=r.data.list,!e.id){o.next=16;break}return t.ruleForm.id=e.id,o.next=14,t.$api.info("xiaoshuo",t.ruleForm.id);case 14:s=o.sent,t.ruleForm=s.data;case 16:e.xiaoshuoId&&(t.ruleForm.xiaoshuoId=e.xiaoshuoId);case 17:case"end":return o.stop()}}),o)})))()},methods:{xiaoshuoTypesChange:function(e){this.xiaoshuoTypesIndex=e.target.value,this.ruleForm.xiaoshuoValue=this.xiaoshuoTypesOptions[this.xiaoshuoTypesIndex].indexName,this.ruleForm.xiaoshuoTypes=this.xiaoshuoTypesOptions[this.xiaoshuoTypesIndex].codeIndex},shangxiaTypesChange:function(e){this.shangxiaTypesIndex=e.target.value,this.ruleForm.shangxiaValue=this.shangxiaTypesOptions[this.shangxiaTypesIndex].indexName,this.ruleForm.shangxiaTypes=this.shangxiaTypesOptions[this.shangxiaTypesIndex].codeIndex},xiaoshuoPhotoTap:function(){var e=this;this.$api.upload((function(t){e.ruleForm.xiaoshuoPhoto=e.$base.url+"upload/"+t.file,e.$forceUpdate(),e.$nextTick((function(){}))}))},createTimeConfirm:function(e){console.log(e),this.ruleForm.createTime=e.result,this.$forceUpdate()},getUUID:function(){return(new Date).getTime()},onSubmitTap:function(){var t=this;return u(a.default.mark((function o(){return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(t.ruleForm.xiaoshuoName){o.next=3;break}return t.$utils.msg("作品名称不能为空"),o.abrupt("return");case 3:if(t.ruleForm.xiaoshuoPhoto){o.next=6;break}return t.$utils.msg("作品封面不能为空"),o.abrupt("return");case 6:if(t.ruleForm.xiaoshuoZuozhe){o.next=9;break}return t.$utils.msg("作者不能为空"),o.abrupt("return");case 9:if(t.ruleForm.xiaoshuoZishu||t.$validate.isIntNumer(t.ruleForm.xiaoshuoZishu)||!(t.ruleForm.xiaoshuoZishu>0)){o.next=12;break}return t.$utils.msg("字数不能为空，不能小于0 格式为数字"),o.abrupt("return");case 12:if(t.ruleForm.xiaoshuoClicknum||t.$validate.isIntNumer(t.ruleForm.xiaoshuoClicknum)||!(t.ruleForm.xiaoshuoClicknum>0)){o.next=15;break}return t.$utils.msg("点击次数不能为空，不能小于0 格式为数字"),o.abrupt("return");case 15:if(!t.ruleForm.id){o.next=20;break}return o.next=18,t.$api.update("xiaoshuo",t.ruleForm);case 18:o.next=22;break;case 20:return o.next=22,t.$api.save("xiaoshuo",t.ruleForm);case 22:e.setStorageSync("pingluenStateState",!0),t.$utils.msgBack("提交成功");case 24:case"end":return o.stop()}}),o)})))()},getDate:function(e){var t=new Date,o=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return"start"===e?o-=60:"end"===e&&(o+=2),a=a>9?a:"0"+a,n=n>9?n:"0"+n,"".concat(o,"-").concat(a,"-").concat(n)},toggleTab:function(e){this.$refs[e].show()}}};t.default=s}).call(this,o("543d")["default"])}},[["0ef3","common/runtime","common/vendor"]]]);